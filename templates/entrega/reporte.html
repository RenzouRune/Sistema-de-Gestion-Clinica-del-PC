{% extends "base.html" %}

{% block content %}
  <h2>Reporte de Entrega</h2>
  {% if mensaje %}
    <p>{{ mensaje }}</p>
  {% endif %}
  <form method="post">
    {% csrf_token %}
    <label for="asignacion">Asignación:</label>
    <select name="asignacion" id="asignacion" required>
      <option value="" disabled selected>Seleccione una asignación</option>
      {% for asignacion in asignaciones %}
        {% for evaluacion in evaluaciones %}
          {% if evaluacion.estudiante == asignacion.estudiante.nombre and evaluacion.equipo == asignacion.equipo.nombre_equipo %}
            <option value="{{ forloop.parentloop.counter0 }}">
              Estudiante: {{ asignacion.estudiante.nombre }}, Equipo: {{ asignacion.equipo.nombre_equipo }}
            </option>
          {% endif %}
        {% endfor %}
      {% endfor %}
    </select>
    <br><br>
    <label>Estado:</label><br>
    <input type="radio" id="entregado" name="estado" value="entregado" required>
    <label for="entregado">Entregado</label><br>
    <input type="radio" id="pendiente" name="estado" value="pendiente">
    <label for="pendiente">Pendiente</label><br>
    <input type="radio" id="en_observacion" name="estado" value="en observacion">
    <label for="en_observacion">En Observación</label><br><br>
    <button type="submit">Registrar Reporte</button>
  </form>

  <h3>Reportes Registrados</h3>
  <ul>
    {% for entrega in entregas %}
      <li>
        Estudiante: {{ entrega.estudiante }}, Equipo: {{ entrega.equipo }}, Cliente: {{ entrega.cliente }}, Estado: {{ entrega.estado }}
      </li>
    {% empty %}
      <li>No hay reportes registrados.</li>
    {% endfor %}
  </ul>

  <a href="{% url 'recepcion' %}"><button type="button">Volver</button></a>
{% endblock %}
